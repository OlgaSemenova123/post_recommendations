# post_recommendations
Pet-project по рекомендации топ-N постов является финальным заданием на курсе Карпова (https://lab.karpov.courses/).

Описание проекта: Представим, что мы построили социальную сеть, которая обладает следующим функционалом: можно отправлять друг другу письма, создавать сообщества, аналогичные группам в известных сетях, и в этих сообществах публиковать посты.
Так же платформа обладает лентой, которую пользователи могут листать и просматривать случайные записи случайных сообществ. Если пост нравится, можно поддержать автора и поставить like.
Все действия пользователей сохраняются, каждая их активность, связанная с просмотром постов, тоже записывается в базу.
Разработчики решили усовершенствовать текущую ленту. А что, если показывать пользователям не случайные посты, а рекомендовать их точечно каждому пользователю из всего имеющегося множества написанных постов?

Задача: построить рекомендательную систему постов в социальной сети. С точки зрения разработки необходимо реализовать сервис, который будет для каждого юзера в любой момент времени возвращать посты, которые пользователю покажут в его ленте соцсети.

Описание данных в таблицах:
Таблица user_data
Cодержит информацию о всех пользователях соц.сети

![image](https://github.com/OlgaSemenova123/post_recommendations/assets/157280225/6fd97559-df14-4838-af5e-3ea51a7fe8b7)

Таблица post_text_df
Содержит информацию о постах и уникальный ID каждой единицы с соответствующим ей текстом и топиком

![image](https://github.com/OlgaSemenova123/post_recommendations/assets/157280225/96914c93-ad2f-46af-b093-de5daaed7878)

Таблица feed_data
Содержит историю о просмотренных постах для каждого юзера в изучаемый период

![image](https://github.com/OlgaSemenova123/post_recommendations/assets/157280225/cf1e0973-7611-448d-99af-dad8d376b083)

Оценка модели идет по HitRate@5.
Эта метрика принимает значение 1, если среди предложенных 5 рекомендаций хотя бы 1 получила в итоге like от пользователя. Даже если все 5 предложенных постов в итоге будут оценены пользователем, все равно hitrate будет равен 1. В противном случае, если ни один из предложенных постов не был оценен пользователем, hitrate  принимает значение 0

Условия для проекта:
- Скорость работы сервиса. Средняя время работы одного запроса должно быть равно 0,5 секунд. 
- Установлены ограничения по памяти: не больше, чем 4 гб RAM на запуск 
- Установлены ограничения на качество модели: HitRate@5 должен быть больше 0.52
  
Для фичей брались данные о пользователях, а так же текст постов анализировался с помощью TF-IDF с последующем уменьшением размерности до 10 столбцов по PCA.
Модель обучалась на CatBoostClassifier, другие категориальные фичи были положены в cat_features.
По итогам качество работы модели HitRate@5 на тестовых данных 0.544. Сервис работает на FASTAPI, проверка endpoint осуществлялась на Postman.

Позже была создана 2 модель (dl_model), там для текста создавались эмбеддинги на основе обученной модели Roberta. Выбрана были именно Roberta, т к в отличии от Bert и DistilBERT: 
1) была обучена на большем количестве данных;
2) имеет динамическое маскирование, что помогает улучшить эмбеддинги.
3) 
Далее аналогично первой модели, обучение было на CatBoostClassifier. В результате HitRate@5 на тестовых данных составил 0.577. Теперь можно реализовать A/B тестирование, где 1 модель будет контрольной, а 2 - тестовой.

Что можно сделать дальше?
1) собрать результаты тестирования;
2) посчитать число лайков на пользователя по критерию Манна-Уитни-Уилкоксона;
3) смотрим, значим ли результат. Если значим, то выбираем 2 модель.
